{% extends 'accounts/home.html' %}
{% load static %}
{% block title %}Documents{% endblock %}

{% block content %}
<link rel="stylesheet" type="text/css" href="{% static 'css/documents_list.css' %}">
<div class="documents-wrapper container mt-5">
    <div class="documents-card p-4 shadow-sm">
        <h2 class="document-title mb-4">ðŸ“š Document List</h2>

        <!-- Status Filter Form -->
        <form method="get" class="mb-3">
            <div class="row g-2 align-items-center">
                <div class="col-auto">
                    <label for="status" class="form-label fw-bold">Filter by Status:</label>
                </div>
                <div class="col-md-4 col-sm-6">
                    <select name="status" id="status" class="form-select" onchange="this.form.submit()">
                        <option value="">All</option>
                        {% for value, label in all_statuses %}
                            <option value="{{ value }}" {% if selected_status == value %}selected{% endif %}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </form>

        <!-- Scrollable Table -->
        <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
            <table class="table table-bordered table-hover align-middle mb-0">
                <thead class="table-light sticky-top bg-white" style="top: 0;">
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Status</th>
                        <th scope="col">Uploaded By</th>
                        <th scope="col">Department</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
{% for doc in documents %}
    <tr>
        <td class="fw-semibold">{{ doc.name }}</td>
        <td>{{ doc.get_status_display }}</td>
        <td>
            {% if doc.uploaded_by %}
                {{ doc.uploaded_by.get_full_name }}
            {% else %}
                {{ doc.uploaded_by_name }}
            {% endif %}
        </td>
        <td>{{ doc.department.name }}</td>
        <td>
            <a href="{% url 'view_document' doc.id %}" class="btn btn-sm btn-outline-primary">View</a>
        </td>
    </tr>
{% empty %}
    <tr>
        <td colspan="5" class="text-center">No documents found.</td>
    </tr>
{% endfor %}

                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
